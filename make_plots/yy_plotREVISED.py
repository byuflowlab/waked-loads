
import numpy as np
import matplotlib.pyplot as plt


if __name__ == '__main__':

            """TI = 0.11"""
            # # #FAST
            # FAST4 = np.array([1.35137908, 1.71541373, 1.98567876, 1.3984026 , 0.94911793,
            #             0.67718382, 0.64275145, 0.77966465, 1.02635052])
            # FAST7 = np.array([1.32492845, 1.52989691, 1.62069779, 1.34037397, 1.03365472,
            #             0.84344457, 0.78222138, 0.83065681, 1.00642498])
            # FAST10 = np.array([1.29584224, 1.39422187, 1.411617  , 1.22741363, 0.95970128,
            #             0.90070624, 0.87901633, 0.87618861, 1.01573045])
            #
            # FASTfree = 1.0875922539496865
            #
            # CC4 = np.array([ 0.95747018,  0.95747027,  0.95747221,  0.95750427,  0.9578723 ,
            #             0.96080659,  0.97694552,  1.03747398,  1.18489344,  1.37103782,
            #             1.38923034,  1.10051281,  0.71421996,  0.47887851,  0.41644526,
            #             0.49104844,  0.67557731,  0.84624982,  0.92904837,  0.95256209,
            #             0.9568804 ,  0.95742037,  0.95746722,  0.95747006,  0.95747018])
            # CC7 = np.array([ 0.95747551,  0.95750993,  0.95771282,  0.95867984,  0.96238909,
            #             0.97374232,  1.00102357,  1.05053285,  1.11074008,  1.13747552,
            #             1.08080282,  0.94873053,  0.78677212,  0.66394124,  0.611998  ,
            #             0.63875774,  0.71989056,  0.81568851,  0.89061773,  0.93245934,
            #             0.94995787,  0.95563939,  0.95710602,  0.95741093,  0.95746229])
            # CC10 = np.array([ 0.95763661,  0.95807379,  0.95938526,  0.96277369,  0.97024496,
            #             0.98406951,  1.00479933,  1.02786568,  1.04114537,  1.02841865,
            #             0.98072148,  0.9062183 ,  0.82707527,  0.7660368 ,  0.73680109,
            #             0.74232147,  0.77623955,  0.82537443,  0.87442203,  0.91247844,
            #             0.93640694,  0.94890693,  0.95443262,  0.95652688,  0.95721321])
            #
            # """Uinf array CCBlade"""
            # CC4 = np.array([0.95686821, 0.9568683 , 0.95687037, 0.95690394, 0.95728456,
            #        0.96028544, 0.97663523, 1.03760663, 1.18742127, 1.38728542,
            #        1.40325364, 1.10492532, 0.71669082, 0.48325678, 0.42471821,
            #        0.50016099, 0.67518066, 0.84448198, 0.92796328, 0.95185088,
            #        0.95626215, 0.95681673, 0.95686513, 0.95686808, 0.95686821])
            # CC7 = np.array([0.95687375, 0.95690929, 0.95711728, 0.95810246, 0.96186008,
            #        0.97330776, 1.00075486, 1.05085438, 1.11400498, 1.1492115 ,
            #        1.10160249, 0.9642297 , 0.79907955, 0.67579992, 0.6252198 ,
            #        0.64629941, 0.72135883, 0.81481518, 0.88948612, 0.93155894,
            #        0.94924096, 0.95500325, 0.95649594, 0.9568074 , 0.95686008])
            # CC10 = np.array([0.95703819, 0.95748225, 0.95880922, 0.96222568, 0.96973803,
            #        0.98362775, 1.00455863, 1.02842416, 1.04409228, 1.03591451,
            #        0.99376537, 0.92326725, 0.84470145, 0.78102169, 0.74728008,
            #        0.74794447, 0.77810627, 0.82520675, 0.87356933, 0.91156767,
            #        0.93560446, 0.9482046 , 0.95378855, 0.9559097 , 0.95660647])

            """TI = 0.056"""
            #FAST
            FAST4 = np.array([1.36776643, 1.89714315, 2.09654972, 1.47612022, 0.83967825,
                        0.61750543, 0.48535682, 0.60648216, 0.95753692])
            FAST7 = np.array([1.32784831, 1.55496394, 1.63731782, 1.37968735, 1.00741318,
                        0.71084738, 0.63311522, 0.71779105, 0.90093821])
            FAST10 = np.array([1.27216204, 1.37212241, 1.38079224, 1.27542983, 1.079142  ,
                        0.8413648 , 0.76696968, 0.76236284, 0.88142521])

            FASTfree = 1.140557544276966

            CC4 = np.array([ 0.95747018,  0.95747018,  0.95747021,  0.95747147,  0.95750966,
                        0.95820905,  0.96596451,  1.01777584,  1.22129889,  1.59890394,
                        1.68786962,  1.24089428,  0.67875156,  0.39057955,  0.32215792,
                        0.41805318,  0.66867037,  0.87807253,  0.94570862,  0.95644108,
                        0.95741522,  0.95746838,  0.95747015,  0.95747018,  0.95747018])
            CC7 = np.array([ 0.95747019,  0.95747037,  0.95747392,  0.95752442,  0.95803436,
                        0.96167573,  0.9799473 ,  1.04369043,  1.19090556,  1.37254094,
                        1.37708451,  1.10316531,  0.7439813 ,  0.51576111,  0.4516839 ,
                        0.52299544,  0.6862808 ,  0.84457932,  0.92636094,  0.95157261,
                        0.95667916,  0.9573943 ,  0.95746497,  0.95746993,  0.95747017])
            CC10 = np.array([ 0.95747086,  0.95747785,  0.95753859,  0.95794884,  0.96009639,
                        0.96875746,  0.99539508,  1.05643818,  1.15268574,  1.23000079,
                        1.19044521,  1.00936853,  0.78394253,  0.62480823,  0.56896169,
                        0.60658388,  0.70956206,  0.82490112,  0.90454021,  0.94147693,
                        0.95374604,  0.95679372,  0.95737385,  0.95745941,  0.95746924])

            CC4 = np.array([0.95686821, 0.95686821, 0.95686824, 0.95686959, 0.95690948,
                   0.95762496, 0.96540632, 1.01646016, 1.21461284, 1.58677204,
                   1.66888387, 1.20496487, 0.64023929, 0.36699061, 0.31171671,
                   0.40907653, 0.65938418, 0.87420577, 0.94452988, 0.95578048,
                   0.95680959, 0.95686627, 0.95686817, 0.95686821, 0.95686821])
            CC7 = np.array([0.95686822, 0.95686841, 0.95687209, 0.95692376, 0.95743802,
                   0.96106049, 0.97899927, 1.04077376, 1.18257518, 1.36016186,
                   1.36448034, 1.08646604, 0.72592152, 0.50305244, 0.44443549,
                   0.51412496, 0.67775613, 0.8398078 , 0.9244393 , 0.95069218,
                   0.95603552, 0.95678784, 0.95686265, 0.95686793, 0.9568682 ])
            CC10 = np.array([0.95686891, 0.95687605, 0.95693736, 0.95734704, 0.95946903,
                   0.96793568, 0.99368049, 1.05198637, 1.14344314, 1.21772387,
                   1.17861311, 0.9983912 , 0.77455681, 0.61660287, 0.560971  ,
                   0.59764715, 0.70120884, 0.81938109, 0.90178131, 0.94017862,
                   0.95297054, 0.95615768, 0.95676658, 0.95685679, 0.9568672 ])



            offsetFAST = np.array([-1.,-0.75,-0.5,-0.25,0.,0.25,0.5,0.75,1.])
            offsetCC = np.linspace(-3.,3.,25)

            fig = plt.figure(1,figsize=[6.,2.5])
            ax1 = plt.subplot(131)
            ax2 = plt.subplot(132)
            ax3 = plt.subplot(133)


            import matplotlib as mpl
            label_size = 8
            mpl.rcParams['xtick.labelsize'] = label_size
            mpl.rcParams['ytick.labelsize'] = label_size

            fontProperties = {'family':'serif','size':8}
            ax1.set_xticklabels(ax1.get_xticks(), fontProperties)
            ax1.set_yticklabels(ax1.get_yticks(), fontProperties)

            ax2.set_xticklabels(ax2.get_xticks(), fontProperties)
            ax2.set_yticklabels(ax2.get_yticks(), fontProperties)

            ax3.set_xticklabels(ax3.get_xticks(), fontProperties)
            ax3.set_yticklabels(ax3.get_yticks(), fontProperties)

            ax1.plot(offsetFAST,FAST4,'o',label='SOWFA+FAST',color='C1',markersize=4)
            ax1.plot(offsetCC,CC4,'o',label='superimposed loads',color='C0',markersize=4)
            ax1.plot(np.array([-3.,-1.]),np.array([1.,1.])*FASTfree,'--',color='C1',label='freestream loads')
            ax1.plot(np.array([1.,3.]),np.array([1.,1.])*FASTfree,'--',color='C1')
            # ax3.legend(loc=2,prop={'family':'serif', 'size':8})

            ax1.set_title('7D',family='serif',fontsize=10)
            ax1.set_ylabel('damage',family='serif',fontsize=10)

            ax1.set_xlabel('offset (D)',family='serif',fontsize=10)


            ax2.plot(offsetFAST,FAST7,'or',color='C1',markersize=4)
            ax2.plot(offsetCC,CC7,'ob',color='C0',markersize=4)
            ax2.plot(np.array([-3.,-1.]),np.array([1.,1.])*FASTfree,'--',color='C1')
            ax2.plot(np.array([1.,3.]),np.array([1.,1.])*FASTfree,'--',color='C1')
            ax2.set_title('7D',family='serif',fontsize=10)
            ax2.set_xlabel('offset (D)',family='serif',fontsize=10)
            #

            ax3.plot(offsetFAST,FAST10,'or',color='C1',markersize=4,label='SOWFA+FAST')
            ax3.plot(offsetCC,CC10,'ob',color='C0',markersize=4,label='CCBlade+gravity')
            ax3.set_title('10D',family='serif',fontsize=10)
            ax3.plot(np.array([-3.,-1.]),np.array([1.,1.])*FASTfree,'--',color='C1',label='freestream\nSOWFA+FAST')
            ax3.plot(np.array([1.,3.]),np.array([1.,1.])*FASTfree,'--',color='C1')
            ax3.set_xlabel('offset (D)',family='serif',fontsize=10)

            ax3.legend(loc=1,prop={'family':'serif', 'size':7})


            ax1.set_yticks((0.5,1.0,1.5,2.0,2.5))
            ax1.set_yticklabels(('0.5','1','1.5','2','2.5'))
            ax2.set_yticks((0.5,1.0,1.5,2.0,2.5))
            ax2.set_yticklabels(('0.5','1','1.5','2','2.5'))
            ax3.set_yticks((0.5,1.0,1.5,2.0,2.5))
            ax3.set_yticklabels(('0.5','1','1.5','2','2.5'))


            ax1.set_xlim(-3.1,3.1)
            ax2.set_xlim(-3.1,3.1)
            ax3.set_xlim(-3.1,3.1)

            ax1.set_xticks((-3.,-2.,-1.,0.,1.,2.,3.))
            ax1.set_xticklabels(('-3','-2','-1','0','1','2','3'))
            ax2.set_xticks((-3.,-2.,-1.,0.,1.,2.,3.))
            ax2.set_xticklabels(('-3','-2','-1','0','1','2','3'))
            ax3.set_xticks((-3.,-2.,-1.,0.,1.,2.,3.))
            ax3.set_xticklabels(('-3','-2','-1','0','1','2','3'))
            # ax1.set_xticks((-1.,-0.5,0.,0.5,1.))
            # ax1.set_xticklabels(('-1','-0.5','0','0.5','1'))
            # ax2.set_xticks((-1.,-0.5,0.,0.5,1.))
            # ax2.set_xticklabels(('-1','-0.5','0','0.5','1'))
            # ax3.set_xticks((-1.,-0.5,0.,0.5,1.))
            # ax3.set_xticklabels(('-1','-0.5','0','0.5','1'))

            ax1.set_title('4D downstream',family='serif',fontsize=10)
            ax2.set_title('7D downstream',family='serif',fontsize=10)
            ax3.set_title('10D downstream',family='serif',fontsize=10)

            plt.subplots_adjust(top = 0.8, bottom = 0.2, right = 0.98, left = 0.1,
            hspace = 0, wspace = 0.2)

            ax1.set_ylim(0.,2.6)
            ax2.set_ylim(0.,2.6)
            ax3.set_ylim(0.,2.6)


            plt.suptitle('5.6% TI',family='serif',fontsize=10)
            # plt.savefig('make_plots/figures/fatigue_damage56REVISED.pdf',transparent=True)
            plt.show()
